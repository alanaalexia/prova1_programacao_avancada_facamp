<!DOCTYPE html>
<html>

<head>
    <title>Formulário</title>
    <header>Formulário</header>
    <style>
        body {
            font-family: arial;
        }

        header {
            color: blue;
            font-weight: bold;
            font-size: larger;
            text-align: center;
            font-family: Arial;
        }

        select,
        textarea,
        option,
        input {
            color: rgb(122, 122, 122);
        }

        .alinha {
            display: inline-block;
            width: 162px;
        }

        .button {
            /* margin-right: 12px; padding: 6px 14px; border: 1px solid #999;
        border-radius: 6px; background: #f2f2f2; cursor: pointer; color: #000; */
            font-weight: bolder;
        }

        pre#saidaJson {
            background: #f7f7f7;
            border: 1px solid #ddd;
            padding: 8px;
            border-radius: 6px;
            max-width: 520px;
            white-space: pre-wrap;
        }

        label {
            font-weight: bold;
            color: green;
            /* títulos em negrito e verde */
        }

        label2 {
            font-weight: bold;
            color: red;
            /* títulos em negrito e verde */
        }

        /* feche a regra que estava aberta para label1 */
label1 {
  font-weight: bold;
  color: rgb(109, 109, 109);
  font-family: monospace;
}

/* NOVO: linha em flex com alinhamento vertical central */
.form-row {
  display: flex;
  align-items: center;  /* centraliza verticalmente o label com o bloco de checkboxes */
  gap: 12px;
  margin: 6px 0;
}

/* mantém a mesma largura da coluna de rótulos */
.form-row .alinha {
  display: flex;
  align-items: center;
  width: 160px;
}

/* coluna dos checkboxes */
.checkbox-group {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

    </style>
</head>

<body>

    <form id="myForm" novalidate onsubmit="return handleSubmit(event)">

        <label for="nome" class="alinha">Nome completo:</label>
        <input type="text" id="nome" name="nome" placeholder=""><br>

        <label for="cpf" class="alinha">CPF:</label>
        <input type="text" id="cpf" name="cpf" placeholder=""><br>

        <label for="email" class="alinha">Email:</label>
        <input type="text" id="email" name="email" placeholder=""><br>

        <label for="senha" class="alinha">Senha:</label>
        <input type="password" id="senha" name="senha" placeholder=""><br><br>

        <label for="telefone" class="alinha">Telefone para contato:</label>
        <input type="text" id="telefone" name="telefone" placeholder=""><br>

        <label for="datanasc" class="alinha">Data de nascimento:</label>
        <input type="date" id="datanasc" name="datanasc" placeholder=""><br>

        <label for="datainsc" class="alinha">Data de inscrição:</label>
        <input type="date" id="datainsc" name="datainsc" placeholder="01012024"><br>

        <label2 for="instrumentos">Instrumento musical:</label2>
        <select name="instrumentos" id="instrumentos">
            <option value="guitarra">Guitarra</option>
            <option value="piano">Piano</option>
            <option value="saxofone">Saxofone</option>
            <option value="violao">Violão</option>
        </select><br>

        <label2 class="alinha">Profissional?</label2>
        <input type="radio" id="sim" name="pprof" value="sim">
        <label1 for="sim">Sim</label1>
        <input type="radio" id="nao" name="pprof" value="nao">
        <label1 for="dolar">Não</label1><br>

        <div class="form-row">
            <label2 class="alinha">Estilos:</label2>
            <div class="checkbox-group">
                <label1><input type="checkbox" id="rockroll" name="estilos" value="rockroll"> Rock &amp; Roll</label1>
                <label1><input type="checkbox" id="pop" name="estilos" value="pop"> Pop</label1>
                <label1><input type="checkbox" id="bossanova" name="estilos" value="bossanova"> Bossa Nova</label1>
                <label1><input type="checkbox" id="samba" name="estilos" value="samba"> Samba</label1>
            </div>
        </div>


        <button class="button" type="submit">Enviar</button>
        <label class="alinha"></label>
        <button class="button" type="button" onclick="handleReset()">Limpar</button>
    </form>

    <script>
        // ==== UTILIDADES ====
        const ACCENTS = "A-Za-zÀ-ÖØ-öø-ÿ"; // letras com acentos
        const onlyLettersAndAt = (s) => new RegExp(`^[${ACCENTS}]+@[${ACCENTS}]+$`).test(s);

        function stripDigits(s) {
            return s.replace(/\D/g, "");
        }

        function isCPFValid(cpfRaw) {
            const cpf = stripDigits(cpfRaw);

            // 11 dígitos e não pode ser sequência repetida
            if (!/^\d{11}$/.test(cpf) || /^(\d)\1{10}$/.test(cpf)) return false;

            // DV1
            let sum = 0;
            for (let i = 0; i < 9; i++) sum += parseInt(cpf[i], 10) * (10 - i);
            let dv1 = 11 - (sum % 11);
            if (dv1 >= 10) dv1 = 0;
            if (dv1 !== parseInt(cpf[9], 10)) return false;

            // DV2
            sum = 0;
            for (let i = 0; i < 10; i++) sum += parseInt(cpf[i], 10) * (11 - i);
            let dv2 = 11 - (sum % 11);
            if (dv2 >= 10) dv2 = 0;
            if (dv2 !== parseInt(cpf[10], 10)) return false;

            return true;
        }

        function parseDateYMD(ymd) {
            // ymd no formato "YYYY-MM-DD"
            const [y, m, d] = ymd.split("-").map(Number);
            if (!y || !m || !d) return null;
            return new Date(y, m - 1, d, 12);
        }

        function todayYMD() {
            const now = new Date();
            const yyyy = now.getFullYear();
            const mm = String(now.getMonth() + 1).padStart(2, "0");
            const dd = String(now.getDate()).padStart(2, "0");
            return `${yyyy}-${mm}-${dd}`;
        }

        // ==== LIMPAR (item 4) ====
        function handleReset() {
            const form = document.getElementById("myForm");
            form.reset();
            console.clear();
            // opcional: focar no primeiro campo
            document.getElementById("nome").focus();
        }

        // Torna a função visível ao botão "Limpar"
        window.handleReset = handleReset;

        // ==== ENVIAR / VALIDAR (itens a–j) ====
        function handleSubmit(event) {
            event.preventDefault();
            const form = document.getElementById("myForm");

            // (a) Obter conteúdo de todos os campos
            const nome = form.nome.value.trim();
            const cpf = form.cpf.value.trim();
            const email = form.email.value.trim();
            const senha = form.senha.value;
            const telefone = form.telefone.value.trim();
            const datanasc = form.datanasc.value;   // "YYYY-MM-DD"
            const datainsc = form.datainsc.value;   // "YYYY-MM-DD"
            const instrumento = form.instrumentos.value;
            const profChecked = form.querySelector('input[name="pprof"]:checked');
            const estilosChecked = form.querySelectorAll('input[name="estilos"]:checked');

            const errors = [];

            // (a) Checar se todos os campos foram preenchidos
            if (!nome || !cpf || !email || !senha || !telefone || !datanasc || !datainsc || !instrumento) {
                errors.push("Preencha todos os campos de texto, data e seleção.");
            }
            if (!profChecked) {
                errors.push("Selecione se é profissional (Sim/Não).");
            }
            if (estilosChecked.length === 0) {
                errors.push("Selecione ao menos um estilo musical.");
            }

            // (b) Nome: pelo menos duas palavras e sem números
            if (nome) {
                const temDígito = /\d/.test(nome);
                const palavras = nome.trim().split(/\s+/).filter(Boolean);
                if (temDígito) errors.push("O nome completo não pode conter números.");
                if (palavras.length < 2) errors.push("Informe ao menos nome e sobrenome.");
            }

            // (c) CPF: formato (aceita com ou sem pontuação) e dígitos verificadores
            if (cpf && !isCPFValid(cpf)) {
                errors.push("CPF inválido (formato/dígitos verificadores).");
            }

            // (d) E-mail: apenas letras e o caractere '@'
            if (email && !onlyLettersAndAt(email)) {
                errors.push("E-mail deve conter apenas letras e um '@' (ex.: joao@dominio).");
            }

            // (e) Senha: ao menos 12 caracteres, com pelo menos um dígito e uma letra maiúscula
            if (senha) {
                if (senha.length < 12) errors.push("A senha deve ter pelo menos 12 caracteres.");
                if (!/[A-Z]/.test(senha)) errors.push("A senha deve conter ao menos uma letra maiúscula.");
                if (!/\d/.test(senha)) errors.push("A senha deve conter ao menos um dígito numérico.");
            }

            // (f) Telefone: apenas dígitos e no máximo 15 dígitos
            if (telefone && !/^\d{1,15}$/.test(telefone)) {
                errors.push("Telefone deve conter apenas dígitos (máx. 15).");
            }

            // (g) Data de nascimento: entre 01/01/1980 e 31/12/2005 (inclusive)
            if (datanasc) {
                const dn = parseDateYMD(datanasc);
                const min = new Date(1980, 0, 1, 12);
                const max = new Date(2005, 11, 31, 12);
                if (!dn || dn < min || dn > max) {
                    errors.push("Data de nascimento deve estar entre 01/01/1980 e 31/12/2005.");
                }
            }

            // (h) Data de inscrição: em 2025 e ANTES da data atual
            if (datainsc) {
                const di = parseDateYMD(datainsc);
                const year = Number(datainsc.slice(0, 4));
                const hojeStr = todayYMD();
                
                if (year !== 2025) {
                    errors.push("A data de inscrição deve estar no ano de 2025.");
                }
                if (!(datainsc < hojeStr)) {
                    errors.push("A data de inscrição deve ser anterior à data de hoje.");
                }
                if (!di) {
                    errors.push("Data de inscrição inválida.");
                }
            }

            
            if (errors.length > 0) {
                alert("Erros encontrados:\n- " + errors.join("\n- "));
                return false;
            }

            
            alert("Formulário enviado com sucesso!");
            form.reset();
            return false; // mantém na mesma página
        }

        
        window.handleSubmit = handleSubmit;
    </script>

</body>

</html>